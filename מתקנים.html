<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>转 转拽 专 - 住 转拽</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            direction: rtl;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #ddd;
        }
        .constraints {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ffeaa7;
        }
        .constraints h3 {
            margin-top: 0;
            color: #856404;
        }
        .constraints ul {
            margin: 0;
            padding-right: 20px;
        }
        .constraints li {
            margin-bottom: 5px;
        }
        .filters {
            background-color: #e9f7fe;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .filter-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        label {
            font-weight: bold;
            white-space: nowrap;
        }
        select, input {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
            min-width: 150px;
        }
        button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        .date-picker-container {
            position: relative;
            display: inline-block;
        }
        .calendar-popup {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 10px;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }
        .calendar {
            width: 300px;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        .calendar-day {
            padding: 8px;
            text-align: center;
            cursor: pointer;
            border-radius: 4px;
            min-height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .calendar-day:hover {
            background-color: #f0f0f0;
        }
        .calendar-day.selected {
            background-color: #4CAF50;
            color: white;
        }
        .calendar-day.other-month {
            color: #ccc;
        }
        .calendar-day.today {
            background-color: #e0f7fa;
            font-weight: bold;
        }
        .calendar-day.disabled {
            color: #ccc;
            cursor: not-allowed;
            background-color: #f5f5f5;
        }
        .week-day {
            padding: 8px;
            text-align: center;
            font-weight: bold;
            background-color: #f5f5f5;
            font-size: 12px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .no-data {
            text-align: center;
            padding: 20px;
            font-style: italic;
            color: #666;
        }
        .summary {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f8ff;
            border-radius: 8px;
        }
        .teacher-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }
        .teacher-tag {
            background-color: #e0e0e0;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .teacher-tag:hover {
            background-color: #d0d0d0;
            transform: translateY(-2px);
        }
        .teacher-tag.active {
            background-color: #4CAF50;
            color: white;
        }
        .date-range {
            color: #666;
            margin-top: 5px;
        }
        .calendar-nav {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            padding: 5px 10px;
            border-radius: 4px;
        }
        .calendar-nav:hover {
            background-color: #f0f0f0;
        }
        .date-display {
            margin: 0 10px;
            font-weight: bold;
            min-width: 120px;
            text-align: center;
        }
        .actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }
        .date-range-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        .facility-limited {
            background-color: #ffeaa7 !important;
        }
        .facility-alternative {
            background-color: #e6f7ff !important;
        }
        .month-navigation {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        .month-btn {
            padding: 5px 10px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .month-btn:hover {
            background-color: #e0e0e0;
        }
        .month-btn.active {
            background-color: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>转 转拽 专 - "</h1>
            <h2>专 2025 -  2026</h2>
            <div class="date-range">转专: 02.11.2025 - 20.06.2026</div>
            <div class="teacher-list">
                <div class="teacher-tag active" data-teacher="all"> 专</div>
                <div class="teacher-tag" data-teacher="转">转</div>
                <div class="teacher-tag" data-teacher="转">转</div>
                <div class="teacher-tag" data-teacher="住">住</div>
                <div class="teacher-tag" data-teacher="砖专">砖专</div>
                <div class="teacher-tag" data-teacher=""></div>
                <div class="teacher-tag" data-teacher="住">住</div>
                <div class="teacher-tag" data-teacher=""></div>
                <div class="teacher-tag" data-teacher="注专">注专</div>
                <div class="teacher-tag" data-teacher="住祝">住祝</div>
            </div>
            <div class="month-navigation">
                <div class="month-btn" data-month="all"> 砖</div>
                <div class="month-btn" data-month="11">专 2025</div>
                <div class="month-btn" data-month="12">爪专 2025</div>
                <div class="month-btn" data-month="1">专 2026</div>
                <div class="month-btn" data-month="2">驻专专 2026</div>
                <div class="month-btn" data-month="3">专抓 2026</div>
                <div class="month-btn" data-month="4">驻专 2026</div>
                <div class="month-btn" data-month="5"> 2026</div>
                <div class="month-btn" data-month="6"> 2026</div>
            </div>
        </div>

        <div class="constraints">
            <h3> 爪 转拽:</h3>
            <ul>
                <li><strong> 砖砖:</strong> 爪   -11:00 注 13:30 (驻 11:00 -  砖)</li>
                <li><strong> 专注:</strong> 爪   注 11:00,  砖 -11:00 注 14:40</li>
                <li><strong> 砖:</strong>  砖 专拽 注 11:00</li>
                <li><strong> :</strong>  转 砖 砖 专砖 砖 注 爪 专砖 转 </li>
                <li><strong> :</strong> 转 砖 专 注 爪  (  爪 专) 砖 专 注 爪 专砖 (  爪 专)</li>
            </ul>
        </div>

        <div class="filters">
            <div class="filter-row">
                <div class="filter-group">
                    <label for="teacherSelect">专 专:</label>
                    <select id="teacherSelect">
                        <option value="all"> 专</option>
                        <option value="转">转</option>
                        <option value="转">转</option>
                        <option value="住">住</option>
                        <option value="砖专">砖专</option>
                        <option value=""></option>
                        <option value="住">住</option>
                        <option value=""></option>
                        <option value="注专">注专</option>
                        <option value="住祝">住祝</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="monthSelect">专 砖:</label>
                    <select id="monthSelect">
                        <option value="all"> 砖</option>
                        <option value="11">专 2025</option>
                        <option value="12">爪专 2025</option>
                        <option value="1">专 2026</option>
                        <option value="2">驻专专 2026</option>
                        <option value="3">专抓 2026</option>
                        <option value="4">驻专 2026</option>
                        <option value="5"> 2026</option>
                        <option value="6"> 2026</option>
                    </select>
                </div>
            </div>

            <div class="filter-row">
                <div class="date-range-title">住 驻  转专</div>
            </div>

            <div class="filter-row">
                <div class="filter-group">
                    <label for="dateFrom">转专:</label>
                    <div class="date-picker-container">
                        <input type="text" id="dateFrom" readonly placeholder="专 转专" style="min-width: 120px;">
                        <div class="calendar-popup" id="calendarFrom">
                            <div class="calendar">
                                <div class="calendar-header">
                                    <button class="calendar-nav" onclick="changeMonth('from', -1)"><i class="fas fa-chevron-right"></i> 砖 拽</button>
                                    <span class="date-display" id="monthDisplayFrom"></span>
                                    <button class="calendar-nav" onclick="changeMonth('from', 1)">砖  <i class="fas fa-chevron-left"></i></button>
                                </div>
                                <div class="calendar-grid" id="calendarGridFrom">
                                    <!--  砖注 -->
                                    <div class="week-day">砖</div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <!--  注  -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="filter-group">
                    <label for="dateTo">注 转专:</label>
                    <div class="date-picker-container">
                        <input type="text" id="dateTo" readonly placeholder="专 转专" style="min-width: 120px;">
                        <div class="calendar-popup" id="calendarTo">
                            <div class="calendar">
                                <div class="calendar-header">
                                    <button class="calendar-nav" onclick="changeMonth('to', -1)"><i class="fas fa-chevron-right"></i> 砖 拽</button>
                                    <span class="date-display" id="monthDisplayTo"></span>
                                    <button class="calendar-nav" onclick="changeMonth('to', 1)">砖  <i class="fas fa-chevron-left"></i></button>
                                </div>
                                <div class="calendar-grid" id="calendarGridTo">
                                    <!--  砖注 -->
                                    <div class="week-day">砖</div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <div class="week-day"></div>
                                    <!--  注  -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="actions">
            <button onclick="filterTable()"><i class="fas fa-filter"></i> 爪 转</button>
            <button onclick="resetFilters()"><i class="fas fa-redo"></i> 驻住 住</button>
            <button onclick="exportToExcel()"><i class="fas fa-file-excel"></i> 爪 -Excel</button>
        </div>

        <div class="summary">
            <strong>住:</strong>
            <span id="summaryText">爪 转 转 注  专转 专 / 砖</span>
        </div>

        <table id="scheduleTable">
            <thead>
                <tr>
                    <th>转专</th>
                    <th></th>
                    <th>砖注</th>
                    <th>专</th>
                    <th>转</th>
                    <th>转拽</th>
                    <th>注专</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <!-- 转 注  爪注转 JavaScript -->
            </tbody>
        </table>
    </div>

    <script>
        // 专砖转 转拽  注 拽 爪
        const availableFacilities = [
            '',
            '爪  ',
            '爪  ',
            '专砖 砖',
            '爪 专砖 ',
            '爪 专砖 ',
            '住',
            '转拽'
        ];

        // 驻拽爪 拽转 爪 转拽
        function checkFacilityConstraints(dateStr, time, day, facility) {
            const hour = parseInt(time.split(':')[0]);
            const minutes = parseInt(time.split(':')[1]);
            const totalMinutes = hour * 60 + minutes;

            //  砖砖 - 爪   -11:00 注 13:30
            if (day === '' && totalMinutes >= 11*60 && totalMinutes <= 13*60+30) {
                if (facility === '') {
                    return { allowed: false, message: ' 砖砖 -11:00 注 13:30 - 爪  ' };
                }
            }

            //  专注 - 爪   注 11:00
            if (day === '' && totalMinutes < 11*60) {
                if (facility === '') {
                    return { allowed: false, message: ' 专注 注 11:00 - 爪  ' };
                }
            }

            //  专注 -  砖 -11:00 注 14:40
            if (day === '' && totalMinutes >= 11*60 && totalMinutes <= 14*60+40) {
                if (facility.includes('爪 ')) {
                    return { allowed: false, message: ' 专注 -11:00 注 14:40 -  砖 ' };
                }
            }

            //  砖 -  砖 专拽 注 11:00
            if (day === '' && totalMinutes >= 11*60) {
                if (facility === '') {
                    return { allowed: false, message: ' 砖 -11:00 -   ' };
                }
            }

            return { allowed: true, message: '' };
        }

        // 驻拽爪 爪转 驻 转拽 注 注驻转 
        function findAlternativeFacility(dateStr, time, day, currentFacility, usedFacilities, allLessons) {
            const hour = parseInt(time.split(':')[0]);
            const minutes = parseInt(time.split(':')[1]);
            const totalMinutes = hour * 60 + minutes;
            
            // 拽  砖 专砖 砖 砖砖
            const hasFullCourt = allLessons.some(lesson => lesson.facility === '专砖 砖');
            const hasHalfCourt = allLessons.some(lesson => lesson.facility.includes('爪 专砖'));
            
            //  砖 专拽 2 专 住  - 注驻转 
            if (allLessons.length === 2) {
                // 拽    驻 爪 
                const hallConstraint = checkFacilityConstraints(dateStr, time, day, '');
                if (hallConstraint.allowed && !usedFacilities.includes('')) {
                    return '';
                }
                
                //    , 住 爪 
                const halfHallAConstraint = checkFacilityConstraints(dateStr, time, day, '爪  ');
                const halfHallBConstraint = checkFacilityConstraints(dateStr, time, day, '爪  ');
                
                if (halfHallAConstraint.allowed && !usedFacilities.includes('爪  ')) {
                    return '爪  ';
                }
                if (halfHallBConstraint.allowed && !usedFacilities.includes('爪  ')) {
                    return '爪  ';
                }
            }
            
            // 专砖转 转拽 驻砖专 驻 住专 注驻转 -  拽
            let preferredFacilities = {
                '爪  ': ['爪  ', '', '转拽', '住', '爪 专砖 ', '爪 专砖 '],
                '爪  ': ['爪  ', '', '转拽', '住', '爪 专砖 ', '爪 专砖 '],
                '爪 专砖 ': ['爪 专砖 ', '', '转拽', '住', '爪  ', '爪  '],
                '爪 专砖 ': ['爪 专砖 ', '', '转拽', '住', '爪  ', '爪  '],
                '': ['专砖 砖', '转拽', '住'],
                '专砖 砖': ['', '转拽', '住'],
                '住': ['', '转拽', '爪  ', '爪  ', '爪 专砖 ', '爪 专砖 '],
                '转拽': ['', '住', '爪  ', '爪  ', '爪 专砖 ', '爪 专砖 ']
            };
            
            //  砖 专 专砖 砖 砖砖,  转 砖转砖 爪 专砖
            if (hasFullCourt && currentFacility.includes('爪 专砖')) {
                preferredFacilities[currentFacility] = preferredFacilities[currentFacility].filter(
                    facility => !facility.includes('爪 专砖')
                );
            }
            
            //  砖 专 爪 专砖 砖砖,  转 砖转砖 专砖 砖
            if (hasHalfCourt && currentFacility === '专砖 砖') {
                preferredFacilities[currentFacility] = preferredFacilities[currentFacility].filter(
                    facility => facility !== '专砖 砖'
                );
            }
            
            // 拽转 专砖转 转拽 注驻 转拽 
            const alternatives = preferredFacilities[currentFacility] || ['', '转拽', '住'];
            
            // 爪转 转拽 驻
            for (const altFacility of alternatives) {
                // 拽  转拽 驻
                if (!usedFacilities.includes(altFacility)) {
                    // 拽转 爪  转拽 驻
                    const constraintCheck = checkFacilityConstraints(dateStr, time, day, altFacility);
                    if (constraintCheck.allowed) {
                        return altFacility;
                    }
                }
            }
            
            //   爪 转拽 驻, 专 转 拽专
            return currentFacility;
        }

        // 驻拽爪 驻转专 转砖转  注 注驻转 
        function resolveConflictsAutomatically(scheduleData) {
            // 爪专转 注转拽 砖 转
            const resolvedData = [...scheduleData];
            
            //  转 驻 转专 砖注
            const scheduleByDate = {};
            resolvedData.forEach(item => {
                if (!scheduleByDate[item.date]) {
                    scheduleByDate[item.date] = {};
                }
                if (!scheduleByDate[item.date][item.time]) {
                    scheduleByDate[item.date][item.time] = [];
                }
                scheduleByDate[item.date][item.time].push(item);
            });
            
            // 驻转专 转砖转  转专 砖注
            Object.keys(scheduleByDate).forEach(date => {
                Object.keys(scheduleByDate[date]).forEach(time => {
                    const lessons = scheduleByDate[date][time];
                    const usedFacilities = [];
                    
                    //  砖 专拽 2 专 - 住 砖 转 
                    if (lessons.length === 2) {
                        const day = lessons[0].day;
                        const hallConstraint = checkFacilityConstraints(date, time, day, '');
                        
                        if (hallConstraint.allowed) {
                            // 转 砖转砖  - 砖转砖 爪 
                            lessons[0].facility = '爪  ';
                            lessons[1].facility = '爪  ';
                            lessons[0].hasAlternative = true;
                            lessons[1].hasAlternative = true;
                            
                            usedFacilities.push('爪  ', '爪  ');
                        } else {
                            //    - 砖 驻 专
                            lessons.forEach(lesson => {
                                const currentFacility = lesson.facility;
                                
                                // 拽转 转砖转 注 专砖 砖 爪 专砖
                                const hasFullCourtConflict = (currentFacility === '专砖 砖' && usedFacilities.some(f => f.includes('爪 专砖')));
                                const hasHalfCourtConflict = (currentFacility.includes('爪 专砖') && usedFacilities.includes('专砖 砖'));
                                
                                if (usedFacilities.includes(currentFacility) || hasFullCourtConflict || hasHalfCourtConflict) {
                                    
                                    const alternative = findAlternativeFacility(
                                        date, time, lesson.day, currentFacility, usedFacilities, lessons
                                    );
                                    
                                    // 注 转拽 拽专 砖爪 驻
                                    if (alternative !== currentFacility) {
                                        lesson.facility = alternative;
                                        lesson.hasAlternative = true;
                                    }
                                }
                                
                                // 住驻转 转拽 专砖转 转拽 砖砖
                                usedFacilities.push(lesson.facility);
                            });
                        }
                    } else {
                        // 转专 -2 专 - 驻 专
                        lessons.forEach(lesson => {
                            const currentFacility = lesson.facility;
                            
                            // 拽转 转砖转 注 专砖 砖 爪 专砖
                            const hasFullCourtConflict = (currentFacility === '专砖 砖' && usedFacilities.some(f => f.includes('爪 专砖')));
                            const hasHalfCourtConflict = (currentFacility.includes('爪 专砖') && usedFacilities.includes('专砖 砖'));
                            
                            if (usedFacilities.includes(currentFacility) || hasFullCourtConflict || hasHalfCourtConflict) {
                                
                                const alternative = findAlternativeFacility(
                                    date, time, lesson.day, currentFacility, usedFacilities, lessons
                                );
                                
                                // 注 转拽 拽专 砖爪 驻
                                if (alternative !== currentFacility) {
                                    lesson.facility = alternative;
                                    lesson.hasAlternative = true;
                                }
                            }
                            
                            // 住驻转 转拽 专砖转 转拽 砖砖
                            usedFacilities.push(lesson.facility);
                        });
                    }
                });
            });
            
            return resolvedData;
        }

        // 驻拽爪 爪专转 转专 转拽驻 专 2025 -  2026
        function generateScheduleData() {
            const scheduleData = [];
            const startDate = new Date(2025, 10, 2); // 2 专 2025
            const endDate = new Date(2026, 5, 20);   // 20  2026
            
            // 专转 注专转 砖注转 驻 拽抓 爪专祝 - 注 拽  砖 转拽
            const weeklySchedule = [
                //  专砖 (0) - 砖注专 0 (07:45) - 专拽 专 砖爪
                { day: 0, time: '7:45', teacher: '注专', class: '12', facility: '转拽' },
                { day: 0, time: '7:45', teacher: '转', class: '10', facility: '' },
                
                //  专砖 (0) - 砖注专 1 (08:30) 
                { day: 0, time: '8:30', teacher: '注专', class: '2', facility: '爪  ' },
                { day: 0, time: '8:30', teacher: '转', class: '2', facility: '住' },
                
                { day: 0, time: '9:15', teacher: '注专', class: '3+4', facility: '专砖 砖' },
                { day: 0, time: '9:15', teacher: '砖专', class: '3+4', facility: '转拽' },
                { day: 0, time: '9:15', teacher: '', class: '5+6', facility: '转拽' },
                { day: 0, time: '9:15', teacher: '转', class: '5+6', facility: '' },
                
                { day: 0, time: '10:15', teacher: '注专', class: '3', facility: '爪  ' },
                { day: 0, time: '10:15', teacher: '砖专', class: '3', facility: '住' },
                { day: 0, time: '10:15', teacher: '住祝', class: '7', facility: '专砖 砖' },
                { day: 0, time: '10:15', teacher: '转', class: '7', facility: '转拽' },
                
                { day: 0, time: '11:00', teacher: '注专', class: '11', facility: '转拽' },
                
                { day: 0, time: '12:00', teacher: '住祝', class: '1', facility: '' },
                { day: 0, time: '12:00', teacher: '转', class: '1', facility: '爪  ' },
                { day: 0, time: '12:00', teacher: '', class: '9', facility: '住' },
                { day: 0, time: '12:00', teacher: '砖专', class: '9', facility: '专砖 砖' },
                
                { day: 0, time: '12:45', teacher: '住祝', class: '6', facility: '转拽' },
                { day: 0, time: '12:45', teacher: '砖专', class: '6', facility: '转拽' },
                
                { day: 0, time: '13:55', teacher: '住祝', class: '4+5', facility: '' },
                { day: 0, time: '13:55', teacher: '转', class: '4+5', facility: '爪  ' },

                //  砖 (1) - 砖注专 0 (07:45) - 专拽 专 砖爪
                { day: 1, time: '7:45', teacher: '注专', class: '11', facility: '爪  ' },
                
                //  砖 (1) - 砖注专 1 (08:30) 
                { day: 1, time: '8:30', teacher: '住祝', class: '11', facility: '住' },
                { day: 1, time: '8:30', teacher: '', class: '11', facility: '专砖 砖' },
                { day: 1, time: '8:30', teacher: '', class: '2', facility: '转拽' },
                { day: 1, time: '8:30', teacher: '转', class: '2', facility: '转拽' },
                { day: 1, time: '8:30', teacher: '砖专', class: '4+10', facility: '' },
                { day: 1, time: '8:30', teacher: '注专', class: '10', facility: '爪  ' },
                { day: 1, time: '8:30', teacher: '住', class: '4', facility: '住' },
                
                { day: 1, time: '9:15', teacher: '住', class: '9', facility: '专砖 砖' },
                { day: 1, time: '9:15', teacher: '', class: '9', facility: '转拽' },
                { day: 1, time: '9:15', teacher: '砖专', class: '3', facility: '转拽' },
                { day: 1, time: '9:15', teacher: '注专', class: '3', facility: '' },
                { day: 1, time: '9:15', teacher: '住祝', class: '7', facility: '爪  ' },
                { day: 1, time: '9:15', teacher: '转', class: '7', facility: '住' },
                
                { day: 1, time: '10:15', teacher: '住', class: '1', facility: '专砖 砖' },
                { day: 1, time: '10:15', teacher: '转', class: '1', facility: '转拽' },
                { day: 1, time: '10:15', teacher: '', class: '8+10', facility: '转拽' },
                { day: 1, time: '10:15', teacher: '', class: '10', facility: '' },
                { day: 1, time: '10:15', teacher: '住祝', class: '8', facility: '爪  ' },
                { day: 1, time: '10:15', teacher: '砖专', class: '1', facility: '住' },
                { day: 1, time: '10:15', teacher: '注专', class: '1', facility: '专砖 砖' },
                
                { day: 1, time: '11:00', teacher: '住', class: '7', facility: '转拽' },
                { day: 1, time: '11:00', teacher: '', class: '7', facility: '转拽' },
                { day: 1, time: '11:00', teacher: '住祝', class: '9', facility: '' },
                { day: 1, time: '11:00', teacher: '住', class: '9', facility: '爪  ' },
                { day: 1, time: '11:00', teacher: '砖专', class: '13', facility: '住' },
                
                { day: 1, time: '12:00', teacher: '住', class: '2', facility: '专砖 砖' },
                { day: 1, time: '12:00', teacher: '', class: '2', facility: '转拽' },
                
                { day: 1, time: '12:45', teacher: '住祝', class: '10', facility: '专砖 砖' },
                { day: 1, time: '12:45', teacher: '砖专', class: '12', facility: '转拽' },
                { day: 1, time: '12:45', teacher: '住', class: '14', facility: '转拽' },
                { day: 1, time: '12:45', teacher: '住', class: '11', facility: '' },
                { day: 1, time: '12:45', teacher: '', class: '转  注砖', facility: '爪  ' },
                
                { day: 1, time: '13:55', teacher: '砖专', class: '5+8', facility: '住' },
                { day: 1, time: '13:55', teacher: '住祝', class: '5', facility: '专砖 砖' },
                { day: 1, time: '13:55', teacher: '住', class: '8', facility: '转拽' },

                //  砖砖 (2) -  砖注专 0 (07:45)
                
                //  砖砖 (2) - 砖注专 1 (08:30) 
                { day: 2, time: '8:30', teacher: '住祝', class: '4+5', facility: '' },
                { day: 2, time: '8:30', teacher: '转', class: '4+5', facility: '爪  ' },
                { day: 2, time: '8:30', teacher: '', class: '7', facility: '住' },
                { day: 2, time: '8:30', teacher: '砖专', class: '7', facility: '专砖 砖' },
                
                { day: 2, time: '9:15', teacher: '砖专', class: '3+8', facility: '' },
                { day: 2, time: '9:15', teacher: '住祝', class: '3', facility: '爪  ' },
                { day: 2, time: '9:15', teacher: '', class: '8', facility: '住' },
                
                { day: 2, time: '10:15', teacher: '住祝', class: '1', facility: '专砖 砖' },
                { day: 2, time: '10:15', teacher: '转', class: '1', facility: '转拽' },
                { day: 2, time: '10:15', teacher: '', class: '9', facility: '转拽' },
                { day: 2, time: '10:15', teacher: '砖专', class: '9', facility: '' },
                
                { day: 2, time: '11:00', teacher: '住祝', class: '6', facility: '爪  ' },
                { day: 2, time: '11:00', teacher: '砖专', class: '6', facility: '住' },
                
                { day: 2, time: '12:00', teacher: '住祝', class: '10', facility: '专砖 砖' },
                { day: 2, time: '12:00', teacher: '住', class: '14', facility: '转拽' },
                
                { day: 2, time: '12:45', teacher: '', class: '2', facility: '转拽' },
                { day: 2, time: '12:45', teacher: '转', class: '2', facility: '爪  ' },

                //  专注 (3) -  砖注专 0 (07:45)
                
                //  专注 (3) - 砖注专 1 (08:30) 
                { day: 3, time: '8:30', teacher: '住', class: '1', facility: '爪  ' },
                { day: 3, time: '8:30', teacher: '转', class: '1', facility: '专砖 砖' },
                { day: 3, time: '8:30', teacher: '住祝', class: '9', facility: '住' },
                { day: 3, time: '8:30', teacher: '住', class: '9', facility: '专砖 砖' },
                
                { day: 3, time: '9:15', teacher: '注专', class: '2', facility: '爪  ' },
                { day: 3, time: '9:15', teacher: '转', class: '2', facility: '住' },
                
                { day: 3, time: '10:15', teacher: '注专', class: '3+4', facility: '住' },
                { day: 3, time: '10:15', teacher: '砖专', class: '3+4', facility: '专砖 砖' },
                { day: 3, time: '10:15', teacher: '', class: '5+6', facility: '转拽' },
                { day: 3, time: '10:15', teacher: '转', class: '5+6', facility: '转拽' },
                
                { day: 3, time: '11:00', teacher: '砖专', class: '5+8', facility: '' },
                { day: 3, time: '11:00', teacher: '住祝', class: '5', facility: '' },
                { day: 3, time: '11:00', teacher: '住', class: '8', facility: '' },
                { day: 3, time: '11:00', teacher: '注专', class: '12', facility: '专砖 砖' },
                { day: 3, time: '11:00', teacher: '转', class: '转  注砖', facility: '转拽' },
                
                { day: 3, time: '12:00', teacher: '砖专', class: '4+10', facility: '' },
                { day: 3, time: '12:00', teacher: '注专', class: '10', facility: '' },
                { day: 3, time: '12:00', teacher: '住', class: '4', facility: '' },
                
                { day: 3, time: '12:45', teacher: '注专', class: '1', facility: '专砖 砖' },
                { day: 3, time: '12:45', teacher: '砖专', class: '1', facility: '转拽' },
                { day: 3, time: '12:45', teacher: '转', class: '转  注砖', facility: '转拽' },
                
                { day: 3, time: '13:55', teacher: '住祝', class: '6', facility: '专砖 砖' },
                { day: 3, time: '13:55', teacher: '砖专', class: '6', facility: '转拽' },

                //  砖 (4) - 砖注专 0 (07:45) - 专拽 专 砖爪
                { day: 4, time: '7:45', teacher: '砖专', class: '13', facility: '' },
                
                //  砖 (4) - 砖注专 1 (08:30) 
                { day: 4, time: '8:30', teacher: '住', class: '7', facility: '爪  ' },
                { day: 4, time: '8:30', teacher: '', class: '7', facility: '住' },
                { day: 4, time: '8:30', teacher: '住祝', class: '6', facility: '专砖 砖' },
                { day: 4, time: '8:30', teacher: '砖专', class: '6', facility: '转拽' },
                
                { day: 4, time: '9:15', teacher: '住', class: '9', facility: '' },
                { day: 4, time: '9:15', teacher: '', class: '9', facility: '爪  ' },
                { day: 4, time: '9:15', teacher: '砖专', class: '3+8', facility: '住' },
                { day: 4, time: '9:15', teacher: '住祝', class: '3', facility: '专砖 砖' },
                { day: 4, time: '9:15', teacher: '', class: '8', facility: '转拽' },
                
                { day: 4, time: '10:15', teacher: '住', class: '2', facility: '' },
                { day: 4, time: '10:15', teacher: '', class: '2', facility: '爪  ' },
                { day: 4, time: '10:15', teacher: '', class: '7', facility: '住' },
                { day: 4, time: '10:15', teacher: '砖专', class: '7', facility: '专砖 砖' },
                
                { day: 4, time: '11:00', teacher: '', class: '14', facility: '转拽' },
                
                { day: 4, time: '12:00', teacher: '住祝', class: '11', facility: '专砖 砖' },
                { day: 4, time: '12:00', teacher: '', class: '11', facility: '爪  ' },
                { day: 4, time: '12:00', teacher: '', class: '13', facility: '住' },
                
                { day: 4, time: '12:45', teacher: '', class: '8+10', facility: '专砖 砖' },
                { day: 4, time: '12:45', teacher: '住祝', class: '8', facility: '转拽' },
                { day: 4, time: '12:45', teacher: '', class: '10', facility: '转拽' }
            ];

            const dayNames = ['', '', '', '', '', '', '砖'];
            
            // 爪专转 转  转拽驻
            let currentDate = new Date(startDate);
            while (currentDate <= endDate) {
                const dayOfWeek = currentDate.getDay(); // 0=专砖, 1=砖, ..., 6=砖转
                
                // 专拽  '-' (专砖-砖)
                if (dayOfWeek >= 0 && dayOfWeek <= 4) {
                    const dateStr = `${currentDate.getDate().toString().padStart(2, '0')}/${(currentDate.getMonth() + 1).toString().padStart(2, '0')}/${currentDate.getFullYear()}`;
                    const hebrewDay = dayNames[dayOfWeek];
                    
                    // 住驻转 砖注专  
                    const dayLessons = weeklySchedule.filter(lesson => lesson.day === dayOfWeek);
                    dayLessons.forEach(lesson => {
                        const constraintCheck = checkFacilityConstraints(dateStr, lesson.time, hebrewDay, lesson.facility);
                        scheduleData.push({
                            date: dateStr,
                            day: hebrewDay,
                            time: lesson.time,
                            teacher: lesson.teacher,
                            class: lesson.class,
                            facility: lesson.facility,
                            constraintMessage: constraintCheck.message,
                            hasConstraint: !constraintCheck.allowed
                        });
                    });
                }
                
                // 注专  
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            return scheduleData;
        }

        // 爪专转 转 注专转 驻转专  砖 转砖转 注 注驻转 
        let scheduleData = resolveConflictsAutomatically(generateScheduleData());

        // 砖转  转 砖
        let currentMonthFrom = new Date(2025, 10, 1); // 专 2025
        let currentMonthTo = new Date(2026, 5, 1);    //  2026
        let selectedDateFrom = null;
        let selectedDateTo = null;

        // 驻拽爪转  砖
        function formatDate(date) {
            return `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
        }

        function getMonthName(date) {
            const months = [
                '专', '驻专专', '专抓', '驻专', '', '',
                '', '住', '住驻专', '拽专', '专', '爪专'
            ];
            return `${months[date.getMonth()]} ${date.getFullYear()}`;
        }

        function isDateInRange(date, startDate, endDate) {
            return date >= startDate && date <= endDate;
        }

        function renderCalendar(type, date) {
            const calendarGrid = document.getElementById(`calendarGrid${type}`);
            const monthDisplay = document.getElementById(`monthDisplay${type}`);
            
            monthDisplay.textContent = getMonthName(date);
            
            // 拽注转  专砖 砖 砖
            const firstDay = new Date(date.getFullYear(), date.getMonth(), 1);
            // 拽注转  专 砖 砖
            const lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0);
            const today = new Date();
            
            //  转专 转专 - 转拽  转  砖
            const minDate = new Date(2025, 10, 2); // 2 专 2025
            const maxDate = new Date(2026, 5, 20); // 20  2026
            
            // 拽 
            while (calendarGrid.children.length > 7) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }
            
            // 住驻转 转 专拽  驻 转转 砖
            const startDay = firstDay.getDay();
            for (let i = 0; i < startDay; i++) {
                const prevDate = new Date(firstDay);
                prevDate.setDate(prevDate.getDate() - (startDay - i));
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                dayElement.textContent = prevDate.getDate();
                calendarGrid.appendChild(dayElement);
            }
            
            // 住驻转  砖
            for (let i = 1; i <= lastDay.getDate(); i++) {
                const currentDate = new Date(date.getFullYear(), date.getMonth(), i);
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                // 拽  转专  转专
                const isInRange = isDateInRange(currentDate, minDate, maxDate);
                
                if (!isInRange) {
                    dayElement.classList.add('disabled');
                } else {
                    // 住  
                    if (currentDate.toDateString() === today.toDateString()) {
                        dayElement.classList.add('today');
                    }
                    
                    // 住 转专 专
                    if (type === 'From' && selectedDateFrom && 
                        currentDate.toDateString() === selectedDateFrom.toDateString()) {
                        dayElement.classList.add('selected');
                    }
                    if (type === 'To' && selectedDateTo && 
                        currentDate.toDateString() === selectedDateTo.toDateString()) {
                        dayElement.classList.add('selected');
                    }
                    
                    dayElement.onclick = function() {
                        selectDate(type, currentDate);
                    };
                }
                
                dayElement.textContent = i;
                calendarGrid.appendChild(dayElement);
            }
            
            // 住驻转 转 专拽  专 住祝 砖
            const endDay = lastDay.getDay();
            const totalCells = 42; // 6 砖专转 * 7 
            const currentCells = startDay + lastDay.getDate();
            const remainingCells = totalCells - currentCells;
            
            for (let i = 1; i <= remainingCells; i++) {
                const nextDate = new Date(lastDay);
                nextDate.setDate(nextDate.getDate() + i);
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                dayElement.textContent = nextDate.getDate();
                calendarGrid.appendChild(dayElement);
            }
        }

        function selectDate(type, date) {
            if (type === 'From') {
                selectedDateFrom = date;
                document.getElementById('dateFrom').value = formatDate(date);
                document.getElementById('calendarFrom').style.display = 'none';
                
                //  转专 "注" 拽 转专 "", 注 转
                if (selectedDateTo && date > selectedDateTo) {
                    selectedDateTo = date;
                    document.getElementById('dateTo').value = formatDate(date);
                    renderCalendar('To', currentMonthTo);
                }
            } else {
                selectedDateTo = date;
                document.getElementById('dateTo').value = formatDate(date);
                document.getElementById('calendarTo').style.display = 'none';
                
                //  转专 ""  转专 "注", 注 转
                if (selectedDateFrom && date < selectedDateFrom) {
                    selectedDateFrom = date;
                    document.getElementById('dateFrom').value = formatDate(date);
                    renderCalendar('From', currentMonthFrom);
                }
            }
        }

        function changeMonth(type, direction) {
            let currentMonth;
            if (type === 'From') {
                currentMonth = currentMonthFrom;
            } else {
                currentMonth = currentMonthTo;
            }
            
            // 爪专转 转专 砖   砖转 转 拽专
            const newMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + direction, 1);
            
            // 拽 砖砖 砖  转专 (专 2025 -  2026)
            const minMonth = new Date(2025, 10, 1); // 专 2025
            const maxMonth = new Date(2026, 5, 1);  //  2026
            
            if (newMonth >= minMonth && newMonth <= maxMonth) {
                if (type === 'From') {
                    currentMonthFrom = newMonth;
                    renderCalendar('From', currentMonthFrom);
                } else {
                    currentMonthTo = newMonth;
                    renderCalendar('To', currentMonthTo);
                }
            }
        }

        // 驻拽爪 注转 
        function loadTable(data = scheduleData) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            if (data.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" class="no-data"> 爪 转 驻 住 砖专</td></tr>';
                return;
            }
            
            data.forEach(item => {
                const row = document.createElement('tr');
                if (item.hasConstraint) {
                    row.classList.add('facility-limited');
                }
                if (item.hasAlternative) {
                    row.classList.add('facility-alternative');
                }
                
                // 爪专转 注 砖转 - 专拽 注专转 注 爪
                let message = item.constraintMessage || '';
                
                row.innerHTML = `
                    <td>${item.date}</td>
                    <td>${item.day}</td>
                    <td>${item.time}</td>
                    <td>${item.teacher}</td>
                    <td>${item.class}</td>
                    <td>${item.facility}</td>
                    <td>${message}</td>
                `;
                tableBody.appendChild(row);
            });
            
            // 注 住
            updateSummary(data);
        }
        
        // 驻拽爪 注 住
        function updateSummary(data) {
            const summaryText = document.getElementById('summaryText');
            const teacher = document.getElementById('teacherSelect').value;
            const month = document.getElementById('monthSelect').value;
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;
            
            let summary = '';
            if (teacher === 'all' && month === 'all' && !dateFrom && !dateTo) {
                summary = `爪 转  转: ${data.length} 砖注专`;
            } else {
                let filters = [];
                if (teacher !== 'all') filters.push(`专: ${teacher}`);
                if (month !== 'all') {
                    const monthNames = {
                        '11': '专 2025', '12': '爪专 2025',
                        '1': '专 2026', '2': '驻专专 2026', '3': '专抓 2026',
                        '4': '驻专 2026', '5': ' 2026', '6': ' 2026'
                    };
                    filters.push(`砖: ${monthNames[month]}`);
                }
                if (dateFrom) filters.push(`转专: ${dateFrom}`);
                if (dateTo) filters.push(`注 转专: ${dateTo}`);
                
                summary = `爪 ${data.length} 砖注专 (${filters.join(', ')})`;
            }
            
            summaryText.textContent = summary;
        }
        
        // 驻拽爪 住 
        function filterTable() {
            const teacher = document.getElementById('teacherSelect').value;
            const month = document.getElementById('monthSelect').value;
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;
            
            let filteredData = scheduleData;
            
            // 住 驻 专
            if (teacher !== 'all') {
                filteredData = filteredData.filter(item => item.teacher === teacher);
            }
            
            // 住 驻 砖 - 转拽: 砖 驻专 
            if (month !== 'all') {
                filteredData = filteredData.filter(item => {
                    const dateParts = item.date.split('/');
                    // 专转 砖 驻专 -住驻专转
                    const itemMonth = dateParts[1].padStart(2, '0');
                    const filterMonth = month.padStart(2, '0');
                    return itemMonth === filterMonth;
                });
            }
            
            // 住 驻  转专
            if (dateFrom) {
                filteredData = filteredData.filter(item => {
                    const itemDate = new Date(item.date.split('/').reverse().join('-'));
                    const fromDate = new Date(dateFrom.split('/').reverse().join('-'));
                    return itemDate >= fromDate;
                });
            }
            
            if (dateTo) {
                filteredData = filteredData.filter(item => {
                    const itemDate = new Date(item.date.split('/').reverse().join('-'));
                    const toDate = new Date(dateTo.split('/').reverse().join('-'));
                    return itemDate <= toDate;
                });
            }
            
            loadTable(filteredData);
        }
        
        // 驻拽爪 驻住 住
        function resetFilters() {
            document.getElementById('teacherSelect').value = 'all';
            document.getElementById('monthSelect').value = 'all';
            document.getElementById('dateFrom').value = '';
            document.getElementById('dateTo').value = '';
            selectedDateFrom = null;
            selectedDateTo = null;
            
            // 驻住 转 砖 转专 专专转 
            currentMonthFrom = new Date(2025, 10, 1);
            currentMonthTo = new Date(2026, 5, 1);
            renderCalendar('From', currentMonthFrom);
            renderCalendar('To', currentMonthTo);
            
            // 驻住 驻转专 专
            document.querySelectorAll('.teacher-tag').forEach(tag => {
                tag.classList.remove('active');
            });
            document.querySelector('.teacher-tag[data-teacher="all"]').classList.add('active');
            
            // 驻住 驻转专 砖
            document.querySelectorAll('.month-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.month-btn[data-month="all"]').classList.add('active');
            
            loadTable();
        }
        
        // 驻拽爪 爪 -Excel
        function exportToExcel() {
            let csv = '转专,,砖注,专,转,转拽,注专\n';
            const dataToExport = getFilteredData();
            
            dataToExport.forEach(item => {
                // 爪专转 注 砖转 - 专拽 注专转 注 爪
                let message = item.constraintMessage || '';
                
                csv += `"${item.date}","${item.day}","${item.time}","${item.teacher}","${item.class}","${item.facility}","${message}"\n`;
            });
            
            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', '转_转拽_专.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // 驻拽爪 拽转 转 住
        function getFilteredData() {
            const teacher = document.getElementById('teacherSelect').value;
            const month = document.getElementById('monthSelect').value;
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;
            
            let filteredData = scheduleData;
            
            if (teacher !== 'all') {
                filteredData = filteredData.filter(item => item.teacher === teacher);
            }
            
            if (month !== 'all') {
                filteredData = filteredData.filter(item => {
                    const dateParts = item.date.split('/');
                    // 专转 砖 驻专 -住驻专转
                    const itemMonth = dateParts[1].padStart(2, '0');
                    const filterMonth = month.padStart(2, '0');
                    return itemMonth === filterMonth;
                });
            }
            
            if (dateFrom) {
                filteredData = filteredData.filter(item => {
                    const itemDate = new Date(item.date.split('/').reverse().join('-'));
                    const fromDate = new Date(dateFrom.split('/').reverse().join('-'));
                    return itemDate >= fromDate;
                });
            }
            
            if (dateTo) {
                filteredData = filteredData.filter(item => {
                    const itemDate = new Date(item.date.split('/').reverse().join('-'));
                    const toDate = new Date(dateTo.split('/').reverse().join('-'));
                    return itemDate <= toDate;
                });
            }
            
            return filteredData;
        }

        // 驻拽爪 专转 专 专砖
        function selectTeacher(teacherName) {
            document.getElementById('teacherSelect').value = teacherName;
            
            // 注 专 
            document.querySelectorAll('.teacher-tag').forEach(tag => {
                tag.classList.remove('active');
            });
            document.querySelector(`.teacher-tag[data-teacher="${teacherName}"]`).classList.add('active');
            
            filterTable();
        }

        // 驻拽爪 专转 砖 专砖
        function selectMonth(monthNumber) {
            document.getElementById('monthSelect').value = monthNumber;
            
            // 注 专 
            document.querySelectorAll('.month-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.month-btn[data-month="${monthNumber}"]`).classList.add('active');
            
            filterTable();
        }

        // 转 转 砖 专注
        document.addEventListener('DOMContentLoaded', function() {
            renderCalendar('From', currentMonthFrom);
            renderCalendar('To', currentMonthTo);
            
            // 爪转  砖 爪 注 砖 转专
            document.getElementById('dateFrom').addEventListener('click', function() {
                document.getElementById('calendarFrom').style.display = 'block';
                document.getElementById('calendarTo').style.display = 'none';
            });
            
            document.getElementById('dateTo').addEventListener('click', function() {
                document.getElementById('calendarTo').style.display = 'block';
                document.getElementById('calendarFrom').style.display = 'none';
            });
            
            // 住专转  砖 爪 抓 
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.date-picker-container')) {
                    document.getElementById('calendarFrom').style.display = 'none';
                    document.getElementById('calendarTo').style.display = 'none';
                }
            });

            // 住驻转 专注 驻转专 专
            document.querySelectorAll('.teacher-tag').forEach(tag => {
                tag.addEventListener('click', function() {
                    const teacher = this.getAttribute('data-teacher');
                    selectTeacher(teacher);
                });
            });

            // 住驻转 专注 驻转专 砖
            document.querySelectorAll('.month-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const month = this.getAttribute('data-month');
                    selectMonth(month);
                });
            });

            // 拽 砖转 爪专 
            console.log('住驻专 砖注专 :', scheduleData.length);
            
            // 拽转 转 砖 砖
            const monthsToCheck = ['11', '12', '1', '2', '3', '4', '5', '6'];
            monthsToCheck.forEach(month => {
                const monthData = scheduleData.filter(item => {
                    const dateParts = item.date.split('/');
                    const itemMonth = dateParts[1].padStart(2, '0');
                    const filterMonth = month.padStart(2, '0');
                    return itemMonth === filterMonth;
                });
                console.log(`砖 ${month}: ${monthData.length} 砖注专`);
            });
        });

        // 注转  专砖转
        window.onload = function() {
            loadTable();
        };
    </script>
</body>
</html>